<!DOCTYPE html>
<html>
<head>
    <title>Firesphere Solr Search user/dev documentation</title>
    <style>
        /*! ADAPTED
      Typeplate : Starter Kit
      URL ........... http://typeplate.com
      Version ....... 3.0.2
      Github ........ https://github.com/typeplate/starter-kit
      Authors ....... Dennis Gaebel (@gryghostvisuals) & Zachary Kain (@zakkain)
      License ....... Creative Commmons Attribution 3.0
      License URL ... https://github.com/typeplate/starter-kit/blob/master/license.txt
      */

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            text-rendering: optimizeLegibility;
            line-height: 1;
            margin-top: 0;
            color: #222;
        }

        blockquote + figcaption cite {
            display: block;
            font-size: inherit;
            text-align: right;
        }

        body {
            word-wrap: break-word;
        }

        pre code {
            word-wrap: normal;
        }

        body {
            -webkit-hyphens: auto;
            -ms-hyphens: auto;
            hyphens: auto;
            color: #444;
        }

        h1 {
            font-size: 2em;
            /* 2*16 = 32 */
        }

        h2 {
            font-size: 1.5em;
            /* 1.5*16 = 24 */
        }

        h3 {
            font-size: 1.17em;
            /* 1.17*16 = 18.72 */
        }

        h4 {
            font-size: 1em;
            /* 1*16 = 16 */
        }

        h5 {
            font-size: 0.83em;
            /* 0.83*16 = 13.28 */
        }

        h6 {
            font-size: 0.75em;
            /* 0.75*16 = 12 */
        }

        h1 {
            margin: 2.42424rem 0 1.454544rem;
        }

        h2 {
            margin: 2.0202rem 0 1.21212rem;
        }

        h3 {
            margin: 1.61616rem 0 1rem;
        }

        h4 {
            margin: 1.21212rem 0 1;
        }

        h5 {
            margin: 0.80808rem 0;
        }

        h6 {
            margin: 0.70707rem 0;
        }

        p {
            margin: auto auto 1.5rem;
        }

        small {
            font-size: 65%;
        }

        input,
        abbr,
        acronym,
        blockquote,
        code,
        kbd,
        q,
        samp,
        var {
            -webkit-hyphens: none;
            -ms-hyphens: none;
            hyphens: none;
        }

        pre {
            white-space: pre;
        }

        pre code {
            white-space: -moz-pre-wrap;
            white-space: pre-wrap;
        }

        code {
            white-space: pre;
            font-family: SF Mono, Consolas, Dejavu Sans Mono, Menlo, monospace;
        }

        abbr {
            -webkit-font-variant: small-caps;
            -moz-font-variant: small-caps;
            -ms-font-variant: small-caps;
            font-variant: small-caps;
            font-weight: 600;
            text-transform: lowercase;
            color: gray;
        }

        abbr[title]:hover {
            cursor: help;
        }

        /* FROM http://purecss.io/layouts/side-menu/  adapted to remove pure classes*/

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
            Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
            "Segoe UI Symbol";
            color: #444;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: auto;
        }

        code,
        pre {
            background-color: #f5f5f5;
            color: #444;
            border-radius: 2px;
            text-shadow: 0px 1px 0px white;
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.15);
        }

        pre code {
            border: none;
            box-shadow: none;
        }

        pre {
            padding: 0.5em;
        }

        code {
            display: inline-block;
            padding: 0 0.5em;
            line-height: 1.4;
            font-size: 0.9em;
        }

        table {
            border-spacing: 0;
            margin-bottom: 1.5rem;
        }

        table th,
        table td {
            padding: 0.3em 0.7em;
        }

        table th {
            background-color: #f4f4f4;
            border-bottom: 2px solid #444;
        }

        table td {
            border: 1px solid #f5f5f5;
        }

        /* Add transition to containers so they can push in and out. */

        #layout,
        #menu,
        .menu-link {
            -webkit-transition: all 0.2s ease-out;
            -moz-transition: all 0.2s ease-out;
            -ms-transition: all 0.2s ease-out;
            -o-transition: all 0.2s ease-out;
            transition: all 0.2s ease-out;
        }

        /* This is the parent `<div>` that contains the menu and the content area. */

        #layout {
            position: relative;
            padding-left: 0;
        }

        #layout.active #menu {
            left: 250px;
            width: 250px;
        }

        #layout.active .menu-link {
            left: 250px;
        }

        /* The content `<div>` is where all your content goes. */

        .content {
            margin: 50px auto;
            padding: 0 2em;
            max-width: 80%;
            line-height: 1.6em;
        }

        /*
        The `#menu` `<div>` is the parent `<div>` that contains the menu that
        appears on the left side of the page.
        */

        #menu {
            margin-left: -250px;
            /* "#menu" width */
            width: 250px;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 1000;
            /* so the menu or its navicon stays above all content */
            background: #f4f4f4;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            font-size: 0.9em;
        }

        a,
        a * {
            text-decoration: none;
            color: #2483cc;
        }

        a:visited {
            text-decoration: none;
            color: #2483cc;
        }

        /* All anchors inside the menu should be styled like this. */

        #menu a {
            display: block;
            padding: 0.5em 0.5em;
        }

        #menu a:first-letter {
            text-transform: capitalize;
        }

        #menu ul {
            list-style-type: none;
            padding: 0;
            margin: 1em 0.5em;
        }

        #menu ul ul {
            margin-top: 0.5em;
            margin-left: 0.5em;
            border-left: 4px solid rgba(255, 255, 255, 0.5);
        }

        /* Change color of the anchor links on hover/focus. */

        #menu li a:hover,
        #menu li a:focus {
            background: rgba(255, 255, 255, 0.4);
        }

        /* This styles the selected menu item `<li>`. */

        #menu li a.active {
            background: rgba(0, 0, 0, 0.05);
        }

        /* This styles a link within a selected menu item `<li>`. */

        #menu li a.active {
            color: #222;
        }

        /* This styles the menu heading. */

        #menu li.heading {
            font-size: 0.9em;
            text-transform: uppercase;
            color: #000;
        }

        #menu li.heading > * {
            padding: 0.5em;
            display: block;
        }

        #menu li.heading a {
            color: #0c68af;
        }

        /* -- Dynamic Button For Responsive Menu -------------------------------------*/

        /*
        `.menu-link` represents the responsive menu toggle that shows/hides on
        small screens.
        */

        .menu-link {
            position: fixed;
            display: block;
            /* show this only on small screens */
            top: 0;
            left: 0;
            /* "#menu width" */
            font-size: 10px;
            /* change this value to increase/decrease button size */
            z-index: 10;
            width: 2em;
            height: auto;
            padding: 1.6em 1.2em;
            border-radius: 0 2px 2px 0;
        }

        .menu-link:hover {
            background: #f4f4f4;
        }

        .menu-link span {
            position: relative;
            display: block;
        }

        .menu-link span,
        .menu-link span:before,
        .menu-link span:after {
            background-color: #555;
            width: 100%;
            height: 0.2em;
            border-radius: 1em;
        }

        .menu-link span:before,
        .menu-link span:after {
            position: absolute;
            margin-top: -0.6em;
            content: " ";
        }

        .menu-link span:after {
            margin-top: 0.6em;
        }

        /* Hides the menu at `48em`, but modify this based on your app's needs. */

        @media (min-width: 48em) {
            .header,
            .content {
                padding-left: 2em;
                padding-right: 2em;
            }

            #layout {
                padding-left: 250px;
                /* left col width "#menu" */
                left: 0;
            }

            #menu {
                left: 250px;
            }

            .menu-link {
                position: fixed;
                left: 250px;
                display: none;
            }

            #layout.active .menu-link {
                left: 250px;
            }
        }

        @media (max-width: 48em) {
            /* Only apply this when the window is small. Otherwise, the following case results in extra padding on the left:
             * Make the window small.
             * Tap the menu to trigger the active state.
             * Make the window large again.
             */
            #layout.active {
                position: relative;
                left: 250px;
            }
        }

        /* Heading anchors and permalinks */
        h1[id],
        h2[id],
        h3[id],
        h4[id],
        h5[id],
        h6[id] {
            position: relative;
        }

        .heading-anchor-permalink {
            /* Position the permalink to the left of the title */
            position: absolute;
            right: 100%;
            /* Add some spacing as padding to not lose the hover */
            padding-right: 0.6rem;
            /* Make it only visible on heading hover, see below */
            opacity: 0;
        }

        h1[id]:hover .heading-anchor-permalink,
        h2[id]:hover .heading-anchor-permalink,
        h3[id]:hover .heading-anchor-permalink,
        h4[id]:hover .heading-anchor-permalink,
        h5[id]:hover .heading-anchor-permalink,
        h6[id]:hover .heading-anchor-permalink {
            opacity: 0.5;
        }
    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta charset="utf-8"/>
</head>

<body>
<div id="layout">
    <!-- Menu toggle -->
    <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
    </a>
    <nav id="menu">
        <ul>
<li><a class="" href="index.html">index</a></li>
<li><a class="" href="01-Changelog.html">Changelog</a></li>
<li><a class="" href="02-Installation.html">Installation</a></li>
<li><a class="" href="03-Solr.html">Solr</a></li>
<li><a class="active" href="04-Usage.html">Usage</a></li>
<li><a class="" href="05-Customisation.html">Customisation</a></li>
<li><a class="" href="06-CMS-Usage.html">CMS Usage</a></li>
<li><a class="" href="07-Fulltext-Search-Compatibility.html">Fulltext Search Compatibility</a></li>
<li><a class="" href="08-Debugging.html">Debugging</a></li>
<li><a class="" href="09-Suggestions.html">Suggestions</a></li>
<li><a class="" href="10-About.html">About</a></li>
<li><a class="" href="15-FAQ.html">FAQ</a></li>
<li><a class="" href="16-Known-issues.html">Known issues</a></li>
</ul>
    </nav>
    <article id="main" class="content">
        <h1 id="usage">Usage <a class="heading-anchor-permalink" href="#usage">#</a></h1>
<h2 id="getting-started">Getting started <a class="heading-anchor-permalink" href="#getting-started">#</a></h2>
<p>First, create an index extending the <code>BaseIndex</code> class. This will require a <code>getIndexName</code> method
which is used to determine the name of the index to query Solr.</p>
<h2 id="configuration">Configuration <a class="heading-anchor-permalink" href="#configuration">#</a></h2>
<p>Configuring Solr is done via YML:</p>
<pre><code class="language-yml">Firesphere\SolrSearch\Services\SolrCoreService:
  config:
    endpoint:
      myhostname:
        host: myhost.com
        port: 8983
        timeout: 10
        # set up timeouts
        index_timeout: 10
        optimize_timeout: 100
        finalize_timeout: 300
        http_method: 'AUTO'
        # commit within 60ms
        commit_within: 60
  # default path settings
  store:
    mode: 'file'
    path: '.solr'
  cores: 2

</code></pre>
<p>The config is used to connect to Solr. This will tell the module where the Solr instance for this index lives and how to connect.</p>
<p>The store is to select the way to configure the solr configuration storage. Options are <code>file</code> and a required path, or <code>post</code> and a required endpoint to post to.</p>
<p>Post config:</p>
<pre><code class="language-yml">store:
  mode: 'post'
  path: '/my_post_endpoint'
  uri: 'https://mydomain.com'
</code></pre>
<h4 id="defining-cores">Defining cores <a class="heading-anchor-permalink" href="#defining-cores">#</a></h4>
<p>If your server has multiple cores available, you can define the amount of cores in the config.
During indexing, this means that each core gets to do an indexing of a group.
The advantage is that it takes all cores available, speeding up the indexing process by the amount of cores available.</p>
<p>Because the amount of cores can not be determined programmatically, due to access control, you will have to define the amount of cores available manually.</p>
<p><strong>NOTE</strong></p>
<p>Given the current situation in server-land, the default amount of cores is 2. This should work fine for
most situations, even if you only have one core available. If you have more cores, you can make this
number larger, of course.</p>
<p><strong>NOTE</strong></p>
<p>Using all cores your system has, will make your website pretty slow during indexing! It is adviced to keep
at least one core free for handling page visits, while you’re running an index.</p>
<h3 id="using-init()">Using init() <a class="heading-anchor-permalink" href="#using-init()">#</a></h3>
<p>Similar to the FulltextSearch module, using init supports all basic methods to add fulltext or filter fields.</p>
<p>Available methods are:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
<th>Required</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>addClass</td>
<td>Add classes to index</td>
<td>Yes</td>
<td><code>$this-&gt;addClass(SiteTree::class);</code></td>
</tr>
<tr>
<td>addFulltextField</td>
<td>Add fields to index</td>
<td>No*</td>
<td><code>$this-&gt;addFulltextField('Content');</code></td>
</tr>
<tr>
<td>addFilterField</td>
<td>Add fields to use for filtering</td>
<td>No</td>
<td><code>$this-&gt;addFilterField('ID');</code></td>
</tr>
<tr>
<td>addBoostedField</td>
<td>Fields to boost by on Query time</td>
<td>No</td>
<td><code>$this-&gt;addBoostedField('Title', ([]/2), 2);</code>**</td>
</tr>
<tr>
<td>addSortField</td>
<td>Field to sort by</td>
<td>No</td>
<td><code>$this-&gt;addSortField('Created');</code></td>
</tr>
<tr>
<td>addCopyField</td>
<td>Add a special copy field, besides the default _text</td>
<td>No</td>
<td><code>$this-&gt;addCopyField('myCopy', ['Fields', 'To', 'Copy']);</code></td>
</tr>
<tr>
<td>addStoredField</td>
<td>Add a field to be stored specifically</td>
<td>No</td>
<td><code>$this-&gt;addStoredField('LastEdited');</code></td>
</tr>
<tr>
<td>addFacetField</td>
<td>Field to build faceting on</td>
<td>No</td>
<td><code>$this-&gt;addFacetField(SiteTree::class, ['Title' =&gt; 'FacetObject', 'Field' =&gt; 'FacetObjectID']);</code></td>
</tr>
</tbody>
</table>
<h3 id="using-yml">Using YML <a class="heading-anchor-permalink" href="#using-yml">#</a></h3>
<pre><code class="language-yml">Firesphere\SolrSearch\Indexes\BaseIndex:
  MySearchIndex:
    Classes:
      - SilverStripe\CMS\Model\SiteTree
    FulltextFields:
      - Content
      - TestObject.Title
      - TestObject.TestRelation.Title
    SortFields: 
	  - Created
    FilterFields:
      - Title
      - Created
      - Firesphere\SolrSearch\Tests\TestObject
    BoostedFields:
	  - Title
    CopyFields:
      _text:
        - '*'
    DefaultField: _text
    FacetFields:
      Firesphere\SolrSearch\Tests\TestObject:
        Field: ID
        Title: TestObject

</code></pre>
<h4 id="moving-from-init-to-yml">Moving from init to YML <a class="heading-anchor-permalink" href="#moving-from-init-to-yml">#</a></h4>
<p>The compatibility module has an extension method that allows you to build your index and then generate the YML content for you. See the compatibility module for more details.</p>
<h2 id="accessing-solr">Accessing Solr <a class="heading-anchor-permalink" href="#accessing-solr">#</a></h2>
<p>If available, you can access your Solr instance at <code>http://mydomain.com:8983</code></p>
<hr>
<p>* Although not required, it’s highly recomended</p>
<p>** The second option of an array can be omitted and directly given the boost value</p>

    </article>
</div>
<script type="text/javascript">
    var _paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function () {
        var u = "https://piwik.casa-laguna.net/";
        _paq.push(['setTrackerUrl', u + 'matomo.php']);
        _paq.push(['setSiteId', '13']);
        var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
        g.type = 'text/javascript';
        g.async = true;
        g.defer = true;
        g.src = u + 'matomo.js';
        s.parentNode.insertBefore(g, s);
    })();
</script>
<noscript><p><img src="https://piwik.casa-laguna.net/matomo.php?idsite=13&amp;rec=1" style="border:0;" alt=""/></p>
</noscript>
<script>
    // FROM http://purecss.io/js/ui.js
    (function (window, document) {
        var layout = document.getElementById("layout"),
            menu = document.getElementById("menu"),
            menuLink = document.getElementById("menuLink");

        function toggleClass(element, className) {
            var classes = element.className.split(/\s+/),
                length = classes.length,
                i = 0;

            for (; i < length; i++) {
                if (classes[i] === className) {
                    classes.splice(i, 1);
                    break;
                }
            }
            // The className is not found
            if (length === classes.length) {
                classes.push(className);
            }

            element.className = classes.join(" ");
        }

        menuLink.onclick = function (e) {
            var active = "active";

            e.preventDefault();
            toggleClass(layout, active);
            toggleClass(menu, active);
            toggleClass(menuLink, active);
        };
    })(this, this.document);
</script>
<script>
    (function () {
        var codeTags = document.querySelectorAll('code[class^="language-"]');
        for (var tag of codeTags) {
            tag.className = tag.className.replace("language-", "prettyprint lang-");
        }
    })();
</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
</body>
</html>
